@using Blazored.FluentValidation
@using global::Shared.Utilities

<MudForm @ref="@_form"
         Model="@_eula"
         ValidationDelay="0">

    <MudGrid Spacing="1">
        <MudItem xs="12">
            <MudNumericField @bind-Value="@_eula.MaxHistoricalDays"
                             Validation="@(async (int i) => await _eulaValidator.ValidateValueAsync(_eula, e => e.MaxHistoricalDays))"
                             Label="Max Historical Days"
                             Variant="Variant.Text"
                             Margin="Margin.Dense"
                             HelperText="Choose a nifty title for your post!"/>
        </MudItem>

        <MudItem xs="12">
            <MudNumericField @bind-Value="@_eula.AccessValidForDays"
                             Validation="@(async (int i) => await _eulaValidator.ValidateValueAsync(_eula, e => e.AccessValidForDays))"
                             Label="Access Valid For (Days)"
                             Variant="Variant.Text"
                             Margin="Margin.Dense"
                             HelperText="For how many days are we allowed to access your data?"/>
        </MudItem>

        <MudItem xs="12">
            <MudSelect T="string"
                       @bind-Value="@_scopesFormBindDummy"
                       Validation="@(async (string s) => await _eulaValidator.ValidateValueAsync(_eula, e => e.AccessScope))"
                       MultiSelection="true"
                       SelectedValuesChanged="OnScopeSelectionChanged"
                       Label="Permissions"
                       Variant="Variant.Text"
                       Margin="Margin.Dense"
                       HelperText="Limit what data we are allowed to access">
                <MudSelectItem Value="@("balances")">Balances</MudSelectItem>
                <MudSelectItem Value="@("details")">Details</MudSelectItem>
                <MudSelectItem Value="@("transactions")">Transactions</MudSelectItem>
            </MudSelect>
            <MudDivider Class="mb-4"/>
        </MudItem>

        <MudItem xs="6">
            <MudButton Variant="Variant.Filled" 
                       Color="Color.Primary" 
                       Class="ml-auto" 
                       OnClick="HandleValidSubmit">Save</MudButton>
        </MudItem>
    </MudGrid>
</MudForm>